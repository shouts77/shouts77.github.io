import{b as xe,e as tt,t as j,a as m,c as we,d as ye}from"../chunks/Bf8EIeX-.js";import{t as H,h as ie,i as be,aa as at,aJ as rt,g as ke,as as st,aD as ot,aC as nt,m as lt,a5 as N,aK as it,y as ct,aG as vt,am as dt,p as ft,ab as X,K as Q,D as U,a as ut,M as $,A as r,aL as ht,c,s as w,r as i,n as mt}from"../chunks/C3k3xJba.js";import{l as gt,e as L,b as pt,s as F}from"../chunks/DY9SC2Sg.js";import{i as S}from"../chunks/eFEshVwY.js";import{s as Ce,r as _t,e as xt,a as $e,i as wt}from"../chunks/DvhvKenV.js";import{s as yt}from"../chunks/CKCmK1Zd.js";import{s as bt,a as kt}from"../chunks/CFXVYhEx.js";import{p as Ct}from"../chunks/BI2Dr0dH.js";import{o as $t}from"../chunks/CwPrTOBV.js";function je(a,l,u=!1,R=!1,g=!1){var v=a,d="";H(()=>{var f=at;if(d===(d=l()??"")){ie&&be();return}if(f.nodes_start!==null&&(rt(f.nodes_start,f.nodes_end),f.nodes_start=f.nodes_end=null),d!==""){if(ie){ke.data;for(var p=be(),z=p;p!==null&&(p.nodeType!==8||p.data!=="");)z=p,p=st(p);if(p===null)throw ot(),nt;xe(ke,z),v=lt(p);return}var I=d+"";u?I=`<svg>${I}</svg>`:R&&(I=`<math>${I}</math>`);var M=tt(I);if((u||R)&&(M=N(M)),xe(N(M),M.lastChild),u||R)for(;N(M);)v.before(N(M));else v.before(M)}})}function jt(a,l,u=l){var R=it();gt(a,"input",g=>{var v=g?a.defaultValue:a.value;if(v=ne(a)?le(v):v,u(v),R&&v!==(v=l())){var d=a.selectionStart,f=a.selectionEnd;a.value=v??"",f!==null&&(a.selectionStart=d,a.selectionEnd=Math.min(f,a.value.length))}}),(ie&&a.defaultValue!==a.value||ct(l)==null&&a.value)&&u(ne(a)?le(a.value):a.value),vt(()=>{var g=l();ne(a)&&g===le(a.value)||a.type==="date"&&!g&&!a.value||g!==a.value&&(a.value=g??"")})}function ne(a){var l=a.type;return l==="number"||l==="range"}function le(a){return a===""?null:+a}function Mt(a){return function(...l){var u=l[0];u.target===this&&(a==null||a.apply(this,l))}}function Me(a){return function(...l){var u=l[0];return u.stopPropagation(),a==null?void 0:a.apply(this,l)}}function St(a,l){var v;var u=(v=a.$$events)==null?void 0:v[l.type],R=dt(u)?u.slice():u==null?[]:[u];for(var g of R)g.call(this,l)}const Dt=!0,Qt=Object.freeze(Object.defineProperty({__proto__:null,prerender:Dt},Symbol.toStringTag,{value:"Module"}));var Lt=j('<span class="absolute left-2 bottom-0 h-[2px] w-8 translate-x-[-1px] bg-blue-400"></span>'),Rt=j('<span class="absolute left-0.5 bottom-0 h-[2px] w-8 translate-x-[-2px] bg-blue-400"></span>'),zt=j('<div class="flex justify-center items-center py-4"><div class="animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-blue-500"></div></div>'),It=j('<span class="px-1 py-0.5 rounded-full bg-gray-100 text-gray-700 shrink-0 text-xs"> </span>'),Bt=j('<p class="mt-0.5 text-xs text-gray-600 bg-yellow-50 p-1 rounded leading-snug"><!></p>'),Et=j('<li><a class="block py-1.5 px-2 hover:bg-gray-50 transition-colors"><div class="flex items-center text-xs gap-1"><span class="text-gray-400 shrink-0 tabular-nums"> </span> <!> <h4 class="font-medium text-gray-800 truncate"><!></h4></div> <!></a></li>'),Ot=j('<div class="p-1 text-center border-t border-gray-100"><a class="text-xs text-blue-600 hover:underline"> </a></div>'),Ht=j('<ul class="divide-y divide-gray-100"></ul> <!>',1),Kt=j('<div class="py-4 text-center"><p class="text-gray-500 text-sm">검색 결과가 없습니다.</p> <p class="text-xs text-gray-400 mt-1">다른 검색어로 시도해보세요.</p></div>'),At=j('<div class="py-4 text-center text-gray-400 text-sm"><p>검색어를 입력하세요</p></div>'),Pt=j('<div class="fixed inset-0 bg-black bg-opacity-30 z-40 flex items-start justify-center pt-14"><div id="search-modal" class="bg-white rounded-md shadow-lg w-[80%] max-w-sm max-h-[75vh] overflow-hidden flex flex-col font-yoo animate-fadeIn svelte-smrll"><div class="p-2 border-b border-gray-100"><div class="flex justify-between items-center mb-1.5"><h3 class="text-sm font-medium text-gray-800">검색</h3> <button class="text-gray-400 hover:text-gray-600" aria-label="닫기"><svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="relative"><input type="text" placeholder="검색어를 입력하세요" class="w-full text-xs py-1 px-2 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"> <button class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600" aria-label="검색"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button></div></div> <div class="overflow-y-auto flex-1"><!></div></div></div>'),Tt=j('<nav class="w-full md:w-96 px-2 pt-1"><div class="flex justify-between items-center font-yoo text-sm"><div class="flex"><a href="/">첫화면 <!></a> <a href="/blog">기록 <!></a></div> <div class="flex items-center space-x-1"><button class="px-1 py-1 text-sm hover:text-blue-600" aria-label="검색" title="검색"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 inline" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button> <a href="https://x.com/shouts2713531" class="px-1 py-1 text-sm hover:text-orange-600" aria-label="X로 이동" title="X로 이동" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 inline" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a> <a href="/rss.xml" class="px-1 py-1 text-sm hover:text-orange-600" aria-label="RSS 피드 구독" title="RSS 피드 구독" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" class="h-2.5 w-2.5 inline" fill="currentColor" viewBox="0 0 24 24"><path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path></svg></a></div></div></nav> <!> <!>',1);function Ut(a,l){ft(l,!0);const[u,R]=bt(),g=()=>kt(Ct,"$page",u);let v=X(!1),d=X(""),f=X(Q([])),p=X(!1),z=X(Q([])),I=Q({}),M=Q({});$t(async()=>{try{console.log("검색 색인 데이터 로드 시도...");const e=await fetch("/search-data/index.json");if(e.ok)$(z,await e.json(),!0),console.log(`검색 색인 로드 완료: ${r(z).length}개 포스트 메타데이터`);else{console.log("색인 파일을 찾을 수 없어 전체 검색 데이터를 로드합니다.");const t=await fetch("/search-data.json");if(t.ok){const s=await t.json();$(z,s.map(h=>{const{content:_,...o}=h;return o}),!0),console.log(`전체 데이터에서 ${r(z).length}개 메타데이터 추출`)}}}catch(e){console.error("검색 데이터 로드 중 오류 발생:",e)}});async function ce(e){if(I[e])return I[e];try{console.log(`카테고리 '${e}' 데이터 로드 중...`);const t=await fetch(`/search-data/category-${e}.json`);if(t.ok){const s=await t.json();return I[e]=s,console.log(`카테고리 '${e}' 데이터 로드 완료: ${s.length}개 포스트`),s}else return console.error(`카테고리 '${e}' 데이터를 찾을 수 없습니다.`),[]}catch(t){return console.error(`카테고리 '${e}' 데이터 로드 중 오류 발생:`,t),[]}}async function Se(e){if(M[e])return M[e];try{console.log(`연도 '${e}' 데이터 로드 중...`);const t=await fetch(`/search-data/year-${e}.json`);if(t.ok){const s=await t.json();return M[e]=s,console.log(`연도 '${e}' 데이터 로드 완료: ${s.length}개 포스트`),s}else return console.error(`연도 '${e}' 데이터를 찾을 수 없습니다.`),[]}catch(t){return console.error(`연도 '${e}' 데이터 로드 중 오류 발생:`,t),[]}}async function De(){try{console.log("전체 검색 데이터 로드 중...");const e=await fetch("/search-data.json");if(e.ok){const t=await e.json();return console.log(`전체 검색 데이터 로드 완료: ${t.length}개 포스트`),t}else return console.error("전체 검색 데이터를 찾을 수 없습니다."),[]}catch(e){return console.error("전체 검색 데이터 로드 중 오류 발생:",e),[]}}function ve(e,t,s=40){if(!e||!t||typeof e!="string")return"";const h=e.toLowerCase(),_=t.toLowerCase(),o=h.indexOf(_);if(o===-1)return"";const y=Math.max(0,o-s),n=Math.min(e.length,o+t.length+s);let C=e.substring(y,n);return y>0&&(C="..."+C),n<e.length&&(C=C+"..."),C}async function de(){const e=r(d).trim().toLowerCase();if(!e){$(f,[],!0);return}$(p,!0);try{let t=r(z).filter(s=>s.title.toLowerCase().includes(e)||s.summary&&s.summary.toLowerCase().includes(e)||s.category.toLowerCase().includes(e));if(t.length===0){console.log("메타데이터에서 결과를 찾지 못했습니다. 전체 내용 검색 중...");const s=[...new Set(r(z).map(n=>n.category))].filter(n=>n.toLowerCase().includes(e)),h=e.match(/\b(20\d{2})\b/),_=h?[h[1]]:[];let o=[];if(s.length>0)for(const n of s){const C=await ce(n);o=[...o,...C]}else if(_.length>0)for(const n of _){const C=await Se(n);o=[...o,...C]}else o=await De();const y=o.filter(n=>n.content&&n.content.toLowerCase().includes(e));t=[...t,...y]}else{console.log(`메타데이터에서 ${t.length}개 결과를 찾았습니다. 컨텍스트 로드 중...`);const s=[...new Set(t.map(o=>o.category))];let h=[];for(const o of s){const y=await ce(o);h=[...h,...y]}const _={};h.forEach(o=>{_[o.slug]=o.content}),t=t.map(o=>{const y=_[o.slug]||"";let n="";return y&&y.toLowerCase().includes(e)?n=ve(y,e,60):o.summary&&o.summary.toLowerCase().includes(e)&&(n=ve(o.summary,e,60)),{...o,matchContext:n}})}$(f,t.sort((s,h)=>{const _=new Date(s.date);return new Date(h.date)-_}),!0)}catch(t){console.error("검색 중 오류 발생:",t),$(f,[],!0)}finally{$(p,!1)}}function K(){$(v,!r(v)),r(v)||($(d,""),$(f,[],!0))}function Le(){r(d).trim()||$(f,[],!0)}function Re(e){e.key==="Enter"&&de()}function ze(e){const t=document.getElementById("search-modal");t&&!t.contains(e.target)&&r(v)&&K()}var fe=Tt();L("click",ht,ze);var Z=U(fe),ue=c(Z),ee=c(ue),G=c(ee),Ie=w(c(G));{var Be=e=>{var t=Lt();m(e,t)};S(Ie,e=>{g().url.pathname==="/"&&e(Be)})}i(G);var te=w(G,2),Ee=w(c(te));{var Oe=e=>{var t=Rt();m(e,t)};S(Ee,e=>{g().url.pathname.startsWith("/blog")&&e(Oe)})}i(te),i(ee);var he=w(ee,2),He=c(he);mt(4),i(he),i(ue),i(Z);var me=w(Z,2);{var Ke=e=>{var t=Pt(),s=c(t),h=c(s),_=c(h),o=w(c(_),2);i(_);var y=w(_,2),n=c(y);_t(n),pt(n);var C=w(n,2);i(y),i(h);var ge=w(h,2),Pe=c(ge);{var Te=D=>{var ae=zt();m(D,ae)},Ye=(D,ae)=>{{var qe=A=>{var J=Ht(),Y=U(J);xt(Y,21,()=>r(f),wt,(B,b)=>{var O=Et(),P=c(O),q=c(P),se=c(q),We=c(se,!0);i(se);var pe=w(se,2);{var Xe=x=>{var k=It(),V=c(k,!0);i(k),H(()=>F(V,r(b).category)),m(x,k)};S(pe,x=>{r(b).category&&x(Xe)})}var _e=w(pe,2),Fe=c(_e);{var Ge=x=>{var k=we(),V=U(k);je(V,()=>r(b).title.replace(new RegExp(r(d),"gi"),oe=>`<mark class="bg-yellow-200 px-0.5 rounded">${oe}</mark>`)),m(x,k)},Je=x=>{var k=ye();H(()=>F(k,r(b).title)),m(x,k)};S(Fe,x=>{r(d)&&r(d).trim()?x(Ge):x(Je,!1)})}i(_e),i(q);var Ne=w(q,2);{var Qe=x=>{var k=Bt(),V=c(k);{var oe=T=>{var W=we(),Ze=U(W);je(Ze,()=>r(b).matchContext.replace(new RegExp(r(d),"gi"),et=>`<mark class="bg-yellow-200 px-0.5 rounded">${et}</mark>`)),m(T,W)},Ue=T=>{var W=ye();H(()=>F(W,r(b).matchContext)),m(T,W)};S(V,T=>{r(d)&&r(d).trim()?T(oe):T(Ue,!1)})}i(k),m(x,k)};S(Ne,x=>{r(b).matchContext&&x(Qe)})}i(P),i(O),H(()=>{$e(P,"href",`/blog/${r(b).slug??""}`),F(We,r(b).date)}),L("click",P,K),m(B,O)}),i(Y);var re=w(Y,2);{var E=B=>{var b=Ot(),O=c(b),P=c(O);i(O),i(b),H(q=>{$e(O,"href",`/search?q=${q??""}`),F(P,`모든 결과 보기 (${r(f).length??""}건)`)},[()=>encodeURIComponent(r(d))]),L("click",O,K),m(B,b)};S(re,B=>{r(f).length>15&&B(E)})}m(A,J)},Ve=(A,J)=>{{var Y=E=>{var B=Kt();m(E,B)},re=E=>{var B=At();m(E,B)};S(A,E=>{r(d)?E(Y):E(re,!1)},J)}};S(D,A=>{r(f).length>0?A(qe):A(Ve,!1)},ae)}};S(Pe,D=>{r(p)?D(Te):D(Ye,!1)})}i(ge),i(s),i(t),H(()=>C.disabled=r(p)),L("click",o,K),jt(n,()=>r(d),D=>$(d,D)),L("keypress",n,Re),L("input",n,Le),L("click",C,de),L("click",s,Me(function(D){St.call(this,l,D)})),L("click",t,Mt(K)),m(e,t)};S(me,e=>{r(v)&&e(Ke)})}var Ae=w(me,2);yt(Ae,()=>l.children),H(e=>{Ce(G,1,`md px-2 py-1 text-sm hover:text-red-800 relative ${g().url.pathname==="/"?"active":""}`,"svelte-smrll"),Ce(te,1,e,"svelte-smrll")},[()=>`md px-2 py-1 text-sm hover:text-red-800 relative ${g().url.pathname.startsWith("/blog")?"active":""}`]),L("click",He,Me(K)),m(a,fe),ut(),R()}export{Ut as component,Qt as universal};
