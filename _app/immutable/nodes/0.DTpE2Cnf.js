import{d as xe,e as Ue,t as p,a as f,c as pe,b as we}from"../chunks/B4-_d8St.js";import{t as B,h as ie,F as ye,a8 as Ge,ag as Ze,g as be,ah as qe,ai as ea,aj as aa,J as ta,a3 as U,ak as ra,v as sa,a9 as oa,p as la,ad as A,q as G,Y as Z,c as o,a as na,u,m as r,al as ia,s as g,r as s,n as ca}from"../chunks/MwnS0lFL.js";import{l as va,d as da,e as ke,s as fa,b as ua,a as J}from"../chunks/CjAMaYxn.js";import{i as w}from"../chunks/DWCJLwC0.js";import{s as oe,r as ha,e as ma,a as Ce,g as _a,i as ga}from"../chunks/Ba-vWabv.js";import{s as xa}from"../chunks/BgSp-R5H.js";import{p as pa}from"../chunks/5q_yWvSJ.js";import{o as wa}from"../chunks/CMMRE-rK.js";function Me(t,i,y=!1,O=!1,x=!1){var v=t,l="";B(()=>{var n=Ge;if(l===(l=i()??"")){ie&&ye();return}if(n.nodes_start!==null&&(Ze(n.nodes_start,n.nodes_end),n.nodes_start=n.nodes_end=null),l!==""){if(ie){be.data;for(var d=ye(),D=d;d!==null&&(d.nodeType!==8||d.data!=="");)D=d,d=qe(d);if(d===null)throw ea(),aa;xe(be,D),v=ta(d);return}var b=l+"";y?b=`<svg>${b}</svg>`:O&&(b=`<math>${b}</math>`);var k=Ue(b);if((y||O)&&(k=U(k)),xe(U(k),k.lastChild),y||O)for(;U(k);)v.before(U(k));else v.before(k)}})}function ya(t,i,y=i){var O=ra();va(t,"input",x=>{var v=x?t.defaultValue:t.value;if(v=le(t)?ne(v):v,y(v),O&&v!==(v=i())){var l=t.selectionStart,n=t.selectionEnd;t.value=v??"",n!==null&&(t.selectionStart=l,t.selectionEnd=Math.min(n,t.value.length))}}),(ie&&t.defaultValue!==t.value||sa(i)==null&&t.value)&&y(le(t)?ne(t.value):t.value),oa(()=>{var x=i();le(t)&&x===ne(t.value)||t.type==="date"&&!x&&!t.value||x!==t.value&&(t.value=x??"")})}function le(t){var i=t.type;return i==="number"||i==="range"}function ne(t){return t===""?null:+t}const ba=!0,Ja=Object.freeze(Object.defineProperty({__proto__:null,prerender:ba},Symbol.toStringTag,{value:"Module"}));function ka(t,i,y){r(i).trim()||u(y,[],!0)}var Ca=p('<span class="absolute left-2 bottom-0 h-[2px] w-8 translate-x-[-1px] bg-blue-400"></span>'),Ma=p('<span class="absolute left-0.5 bottom-0 h-[2px] w-8 translate-x-[-2px] bg-blue-400"></span>'),ja=(t,i)=>t.key==="Escape"&&i(),La=t=>t.stopPropagation(),Sa=(t,i)=>t.key==="Escape"&&i(),$a=p('<div class="flex justify-center items-center py-4"><div class="animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-blue-500"></div></div>'),Ra=p("<span> </span>"),za=p('<p class="mt-0.5 text-xs text-gray-600 bg-yellow-50 p-1 rounded leading-snug"><!></p>'),Ea=p('<li><a class="block py-1.5 px-2 hover:bg-gray-50 transition-colors"><div class="flex items-center text-xs gap-1"><span class="text-gray-400 shrink-0 tabular-nums"> </span> <!> <h4 class="font-medium text-gray-800 truncate"><!></h4></div> <!></a></li>'),Ia=p('<div class="p-1 text-center border-t border-gray-100"><a class="text-xs text-blue-600 hover:underline"> </a></div>'),Ba=p('<ul class="divide-y divide-gray-100"></ul> <!>',1),Oa=p('<div class="py-4 text-center"><p class="text-gray-500 text-sm">검색 결과가 없습니다.</p> <p class="text-xs text-gray-400 mt-1">다른 검색어로 시도해보세요.</p></div>'),Da=p('<div class="py-4 text-center text-gray-400 text-sm"><p>검색어를 입력하세요</p></div>'),Ha=p('<div class="fixed inset-0 bg-black bg-opacity-30 z-40 flex items-start justify-center pt-14" role="button" tabindex="0"><div id="search-modal" class="bg-white rounded-md shadow-lg w-[80%] max-w-sm max-h-[75vh] overflow-hidden flex flex-col font-yoo animate-fadeIn svelte-smrll" role="dialog" aria-modal="true" tabindex="-1"><div class="p-2 border-b border-gray-100"><div class="flex justify-between items-center mb-1.5"><h3 class="text-sm font-medium text-gray-800">검색</h3> <button class="text-gray-400 hover:text-gray-600" aria-label="닫기"><svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="relative"><input type="text" placeholder="검색어를 입력하세요" class="w-full text-xs py-1 px-2 border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-400"> <button class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600" aria-label="검색"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button></div></div> <div class="overflow-y-auto flex-1"><!></div></div></div>'),Pa=p('<nav class="w-full md:w-96 px-2 pt-1"><div class="flex justify-between items-center font-yoo text-sm"><div class="flex"><a href="/">첫화면 <!></a> <a href="/blog">기록 <!></a></div> <div class="flex items-center space-x-1"><button class="px-1 py-1 text-sm hover:text-blue-600" aria-label="검색" title="검색"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 inline" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button> <a href="https://x.com/shouts2713531" class="px-1 py-1 text-sm hover:text-orange-600" aria-label="X로 이동" title="X로 이동" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 inline" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a> <a href="/rss.xml" class="px-1 py-1 text-sm hover:text-orange-600" aria-label="RSS 피드 구독" title="RSS 피드 구독" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" class="h-2.5 w-2.5 inline" fill="currentColor" viewBox="0 0 24 24"><path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"></path></svg></a></div></div></nav> <!> <!>',1);function Na(t,i){la(i,!0);const[y,O]=fa(),x=()=>ua(pa,"$page",y);let v=A(!1),l=A(""),n=A(G([])),d=A(!1),D=A(G([]));G({}),G({});let b=[];wa(async()=>{try{console.log("검색 색인 데이터 로드 시도...");const a=await fetch("/search-data/index.json");if(a.ok)u(D,await a.json(),!0),console.log(`검색 색인 로드 완료: ${r(D).length}개 포스트 메타데이터`);else{console.log("색인 파일을 찾을 수 없어 전체 검색 데이터를 로드합니다.");const e=await fetch("/search-data.json");if(e.ok){const c=await e.json();u(D,c.map(C=>{const{content:S,...M}=C;return M}),!0),console.log(`전체 데이터에서 ${r(D).length}개 메타데이터 추출`)}}}catch(a){console.error("검색 데이터 로드 중 오류 발생:",a)}});function k(){const a=r(l).trim().toLowerCase();if(!a){u(n,[],!0);return}u(d,!0);try{!b||b.length===0?fetch("/search-data.json").then(e=>e.json()).then(e=>{b=e,ce(a)}).catch(e=>{console.error("검색 데이터 로드 실패:",e),u(n,[],!0),u(d,!1)}):ce(a)}catch(e){console.error("검색 중 오류 발생:",e),u(n,[],!0),u(d,!1)}}function ce(a){console.log(`검색어: "${a}"`),u(n,b.filter(e=>{const c=e.title&&e.title.toLowerCase().includes(a),C=e.content&&e.content.toLowerCase().includes(a),S=e.summary&&e.summary.toLowerCase().includes(a),M=e.category&&e.category.toLowerCase().includes(a);return e.content&&e.content.toLowerCase().includes(a)&&console.log(`포스트 '${e.title}'에서 '${a}' 키워드 발견`),c||C||S||M}).map(e=>{let c="";return e.content&&e.content.toLowerCase().includes(a)?(c=ve(e.content,a,60),console.log(`컨텍스트 추출: "${c}"`)):e.summary&&e.summary.toLowerCase().includes(a)&&(c=ve(e.summary,a,60)),{slug:e.slug,title:e.title,date:e.date,category:e.category||"미분류",summary:e.summary||"",matchContext:c}}).sort((e,c)=>new Date(c.date)-new Date(e.date)),!0),console.log(`검색 결과: ${r(n).length}개 포스트 찾음`),u(d,!1)}function ve(a,e,c=40){if(!a||!e||typeof a!="string")return"";const C=a.toLowerCase(),S=e.toLowerCase(),M=C.indexOf(S);if(M===-1)return"";const K=Math.max(0,M-c),$=Math.min(a.length,M+e.length+c);let R=a.substring(K,$);return K>0&&(R="..."+R),$<a.length&&(R=R+"..."),R}function L(){u(v,!r(v)),r(v)||(u(l,""),u(n,[],!0))}function je(a){a.key==="Enter"&&k()}function Le(a){const e=document.getElementById("search-modal");e&&!e.contains(a.target)&&r(v)&&L()}var de=Pa();ke("click",ia,Le);var q=Z(de),fe=o(q),ee=o(fe),N=o(ee),Se=g(o(N));{var $e=a=>{var e=Ca();f(a,e)};w(Se,a=>{x().url.pathname==="/"&&a($e)})}s(N);var ae=g(N,2),Re=g(o(ae));{var ze=a=>{var e=Ma();f(a,e)};w(Re,a=>{x().url.pathname.startsWith("/blog")&&a(ze)})}s(ae),s(ee);var ue=g(ee,2),Ee=o(ue);Ee.__click=L,ca(4),s(ue),s(fe),s(q);var he=g(q,2);{var Ie=a=>{var e=Ha();e.__click=L,e.__keydown=[ja,L];var c=o(e);c.__click=[La],c.__keydown=[Sa,L];var C=o(c),S=o(C),M=g(o(S),2);M.__click=L,s(S);var K=g(S,2),$=o(K);ha($),$.__input=[ka,l,n];var R=g($,2);R.__click=k,s(K),s(C);var me=g(C,2),Oe=o(me);{var De=z=>{var te=$a();f(z,te)},He=(z,te)=>{{var Pe=H=>{var Q=Ba(),F=Z(Q);ma(F,21,()=>r(n),ga,(j,h)=>{var I=Ea(),P=o(I);P.__click=L;var V=o(P),se=o(V),Ke=o(se,!0);s(se);var _e=g(se,2);{var Fe=m=>{var _=Ra(),W=o(_,!0);s(_),B(X=>{oe(_,1,`px-1 py-0 rounded shrink-0 text-xs ${X??""}`,"svelte-smrll"),J(W,r(h).category)},[()=>_a(r(h).category)]),f(m,_)};w(_e,m=>{r(h).category&&m(Fe)})}var ge=g(_e,2),Ve=o(ge);{var We=m=>{var _=pe(),W=Z(_);Me(W,()=>r(h).title.replace(new RegExp(r(l),"gi"),X=>`<mark class="bg-yellow-200 px-0.5 rounded">${X}</mark>`)),f(m,_)},Xe=m=>{var _=we();B(()=>J(_,r(h).title)),f(m,_)};w(Ve,m=>{r(l)&&r(l).trim()?m(We):m(Xe,!1)})}s(ge),s(V);var Ye=g(V,2);{var Ae=m=>{var _=za(),W=o(_);{var X=T=>{var Y=pe(),Ne=Z(Y);Me(Ne,()=>r(h).matchContext.replace(new RegExp(r(l),"gi"),Qe=>`<mark class="bg-yellow-200 px-0.5 rounded">${Qe}</mark>`)),f(T,Y)},Je=T=>{var Y=we();B(()=>J(Y,r(h).matchContext)),f(T,Y)};w(W,T=>{r(l)&&r(l).trim()?T(X):T(Je,!1)})}s(_),f(m,_)};w(Ye,m=>{r(h).matchContext&&m(Ae)})}s(P),s(I),B(()=>{Ce(P,"href",`/blog/${r(h).slug??""}`),J(Ke,r(h).date)}),f(j,I)}),s(F);var re=g(F,2);{var E=j=>{var h=Ia(),I=o(h);I.__click=L;var P=o(I);s(I),s(h),B(V=>{Ce(I,"href",`/search?q=${V??""}`),J(P,`모든 결과 보기 (${r(n).length??""}건)`)},[()=>encodeURIComponent(r(l))]),f(j,h)};w(re,j=>{r(n).length>15&&j(E)})}f(H,Q)},Te=(H,Q)=>{{var F=E=>{var j=Oa();f(E,j)},re=E=>{var j=Da();f(E,j)};w(H,E=>{r(l)?E(F):E(re,!1)},Q)}};w(z,H=>{r(n).length>0?H(Pe):H(Te,!1)},te)}};w(Oe,z=>{r(d)?z(De):z(He,!1)})}s(me),s(c),s(e),B(()=>R.disabled=r(d)),ke("keypress",$,je),ya($,()=>r(l),z=>u(l,z)),f(a,e)};w(he,a=>{r(v)&&a(Ie)})}var Be=g(he,2);xa(Be,()=>i.children),B(a=>{oe(N,1,`md px-2 py-1 text-sm hover:text-red-800 relative ${x().url.pathname==="/"?"active":""}`,"svelte-smrll"),oe(ae,1,a,"svelte-smrll")},[()=>`md px-2 py-1 text-sm hover:text-red-800 relative ${x().url.pathname.startsWith("/blog")?"active":""}`]),f(t,de),na(),O()}da(["click","keydown","input"]);export{Na as component,Ja as universal};
